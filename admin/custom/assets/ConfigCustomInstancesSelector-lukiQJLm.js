import{j as h}from"./jsx-runtime-DRs2ITYJ.js";import{C as u,a as $}from"./ConfigCustomKissHomeDefenderSet__loadShare___mf_0_mui_mf_1_icons_mf_2_material__loadShare__-7IQ5unOt.js";import{C as _}from"./ConfigCustomKissHomeDefenderSet__loadShare___mf_0_iobroker_mf_1_adapter_mf_2_react_mf_2_v5__loadShare__-CQ1_3aHH.js";import{C as R,a as D}from"./ConfigCustomKissHomeDefenderSet__mf_v__runtimeInit__mf_v__-CREQbT0Z.js";const x=[];for(let i=0;i<256;++i)x.push((i+256).toString(16).slice(1));function P(i,t=0){return(x[i[t+0]]+x[i[t+1]]+x[i[t+2]]+x[i[t+3]]+"-"+x[i[t+4]]+x[i[t+5]]+"-"+x[i[t+6]]+x[i[t+7]]+"-"+x[i[t+8]]+x[i[t+9]]+"-"+x[i[t+10]]+x[i[t+11]]+x[i[t+12]]+x[i[t+13]]+x[i[t+14]]+x[i[t+15]]).toLowerCase()}let E;const z=new Uint8Array(16);function U(){if(!E){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");E=crypto.getRandomValues.bind(crypto)}return E(z)}const q=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),O={randomUUID:q};function G(i,t,a){var o;i=i||{};const n=i.random??((o=i.rng)==null?void 0:o.call(i))??U();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,P(n)}function S(i,t,a){return O.randomUUID&&!i?O.randomUUID():G(i)}const{loadShare:N}=D,{initPromise:F}=R,X=F.then(i=>N("@iobroker/json-config",{customShareInfo:{shareConfig:{singleton:!0,strictVersion:!1,requiredVersion:"*"}}})),W=await X.then(i=>i());var b=W;const g={table:{minWidth:400},header:{fontSize:16,fontWeight:"bold"},td:{padding:"2px 16px"},vendor:{maxWidth:150,fontSize:12,textOverflow:"ellipsis",overflow:"hidden"}};async function B(i,t){const a=await i.getObjectViewSystem("state",`${t}.`,`${t}.香`),n=[],o=Object.keys(a).filter(d=>d.endsWith(".address"));for(let d=0;d<o.length;d++){const e=o[d],s=await i.getState(e);s!=null&&s.val&&n.push({ip:s.val,name:"homekit-controller"})}return n}async function H(i,t){const a=await i.getObjectViewSystem("state",`${t}.`,`${t}.香`),n=[],o=Object.keys(a).filter(d=>d.endsWith(".address"));for(let d=0;d<o.length;d++){const e=o[d],s=await i.getState(e);s!=null&&s.val&&n.push({ip:s.val,name:"homekit-controller"})}return n}async function J(i,t){const a=await i.getObjectViewSystem("state",`${t}.`,`${t}.香`),n=[],o=Object.keys(a).filter(d=>d.endsWith(".hostname"));for(let d=0;d<o.length;d++){const e=o[d],s=await i.getState(e);s!=null&&s.val&&n.push({ip:s.val,name:"shelly"})}return n}async function K(i,t){var d,e;const a=await i.getObjectViewSystem("state",`${t}.info.clients.`,`${t}.info.clients.香`),n=[],o=Object.values(a);for(let s=0;s<o.length;s++)(e=(d=o[s])==null?void 0:d.native)!=null&&e.ip&&n.push({ip:o[s].native.ip,name:t.split(".")[0]});return n}async function L(i,t){var d,e,s;const a=await i.getObjectViewSystem("device",`${t}.`,`${t}.香`),n=Object.values(a),o=[];for(let c=0;c<n.length;c++)((d=n[c])==null?void 0:d.type)==="device"&&((s=(e=n[c])==null?void 0:e.native)!=null&&s.ip)&&o.push({ip:n[c].native.ip,name:t.split(".")[0]});return o}const Y=[{adapter:"broadlink2",attr:"additional"},{adapter:"harmony",attr:"devices",arrayAttr:"ip"},{adapter:"hm-rpc",attr:"homematicAddress"},{adapter:"homeconnect",browse:H},{adapter:"homekit-controller",attr:"discoverIp",browse:B},{adapter:"hue",attr:"bridge"},{adapter:"knx",attr:"bind"},{adapter:"lgtv",attr:"ip"},{adapter:"loxone",attr:"host"},{adapter:"mihome-vacuum",attr:"ip"},{adapter:"modbus",attr:"params.bind",clients:!0},{adapter:"mqtt",attr:"url",clients:!0},{adapter:"mqtt-client",attr:"host"},{adapter:"lcn",attr:"host"},{adapter:"knx",attr:"gwip"},{adapter:"onvif"},{adapter:"openknx",attr:"gwip"},{adapter:"broadlink2",attr:"additional"},{adapter:"proxmox",attr:"ip"},{adapter:"samsung",attr:"ip"},{adapter:"shelly",browse:J},{adapter:"sonoff",clients:!0},{adapter:"sonos",attr:"devices",arrayAttr:"ip"},{adapter:"tr-064",attr:"iporhost"},{adapter:"unify",attr:"controllerIp"},{adapter:"upnp",browse:L},{adapter:"wled",attr:"devices",arrayAttr:"ip"},{adapter:"wifilight",attr:"devices",arrayAttr:"ip"}];function A(i){return i?typeof i!="string"?!1:(i=i.trim().toUpperCase().replace(/\s/g,""),!i||i.match(/^([0-9A-F]{2}[:-]){5}([0-9A-F]{2})$/)?!0:!!i.match(/^([0-9A-F]{12})$/)):!0}function I(i){return!i||!A(i)?i||"":(i=i.toUpperCase().trim().replace(/[\s:-]/g,""),i.replace(/(..)(..)(..)(..)(..)(..)/,"$1:$2:$3:$4:$5:$6"))}function M(i){return i?typeof i!="string"?!1:(i=i.trim(),i?i.match(/^\d+\.\d+\.\d+\.\d+$/)?!i.trim().split(".").map(a=>parseInt(a,10)).find(a=>a<0||a>255):!1:!0):!0}function V(i){return!i||!M(i)?i:i.trim().split(".").map(a=>parseInt(a,10)).join(".")}class j extends b.ConfigGeneric{resolveDone=!1;validateTimeout=null;statusPolling=null;async componentDidMount(){var c;super.componentDidMount();let t=[];const a=await this.props.oContext.socket.getObject(`system.adapter.kisshome-defender.${this.props.oContext.instance}`);if(a!=null&&a.common.host){const r=await this.props.oContext.socket.getObject(`system.host.${a.common.host}`);(c=r==null?void 0:r.common)!=null&&c.address&&(t=r.common.address)}const o=(await this.props.oContext.socket.getAdapterInstances()).filter(r=>{var p;return((p=r==null?void 0:r.common)==null?void 0:p.adminUI)&&(r.common.adminUI.config!=="none"||r.common.adminUI.tab)}).map(r=>({id:r._id.replace(/^system\.adapter\./,""),name:r.common.name,native:r.native})).sort((r,p)=>r.id>p.id?1:r.id<p.id?-1:0),d=b.ConfigGeneric.getValue(this.props.data,"devices")||[];d.forEach(r=>{r.uuid||(r.uuid=S())});const e=await this.collectIpAddresses(o,t,d),s={instances:o,ips:e,IP2MAC:{},MAC2VENDOR:{},alive:this.props.alive,resolving:!1,showMessage:!1,modelStatus:{}};this.resolveDone=!1,this.setState(s),await this.props.oContext.socket.subscribeState(`system.adapter.kisshome-defender.${this.props.oContext.instance}.alive`,this.onAliveChanged),this.props.alive&&this.resolveMACs(),this.disableFritzBox(),this.checkDevices(d),this.getModelStatus(),this.pollModelStatus()}getModelStatus(){this.state.alive&&this.props.oContext.socket.sendTo(`kisshome-defender.${this.props.oContext.instance}`,"getModelStatus",{}).then(t=>{t.modelStatus&&this.setState({modelStatus:t.modelStatus})})}pollModelStatus(){this.state.alive?this.statusPolling||=setInterval(()=>{if(!this.state.alive){this.statusPolling&&(clearInterval(this.statusPolling),this.statusPolling=null);return}this.getModelStatus()},1e4):this.statusPolling&&(clearInterval(this.statusPolling),this.statusPolling=null)}resolveMACs(){this.resolveDone=!0,this.setState({runningRequest:!0},()=>{const t=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],a=[];return t.forEach(n=>{const o=V(n.ip),d=I(n.mac);o&&M(o)?a.push({ip:o,mac:d}):d&&A(d)&&a.push({ip:o,mac:d})}),this.state.ips.forEach(n=>{const o=V(n.ip),d=I(n.mac);o&&M(o)&&!a.find(e=>e.ip===o)?a.push({ip:o,mac:d}):d&&A(d)&&!a.find(e=>e.ip===o)&&a.push({ip:o,mac:d})}),this.props.oContext.socket.sendTo(`kisshome-defender.${this.props.oContext.instance}`,"getMacForIps",a).then(n=>{var r;if(n!=null&&n.error){this.setState({runningRequest:!1});return}const o=n,d={...this.state.IP2MAC||{}},e={...this.state.MAC2VENDOR||{}},s=JSON.parse(JSON.stringify(this.state.ips));(r=o==null?void 0:o.result)==null||r.forEach(p=>{const l=p.ip,m=s.findIndex(y=>y.ip===l);m!==-1&&(s[m].mac=p.mac),d[V(l)]=p.mac,e[I(p.mac)]=p.vendor});let c=!1;t.forEach(p=>{const l=s.findIndex(m=>m.ip===p.ip);l!==-1&&s[l].mac&&p.mac!==s[l].mac&&(c=!0,p.mac=s[l].mac)}),this.setState({ips:s,IP2MAC:d,MAC2VENDOR:e,runningRequest:!1}),c&&this.onChange("devices",t)}).catch(n=>{n.toString()!=="no results"&&window.alert(`Cannot get MAC addresses: ${n}`),this.setState({runningRequest:!1})})})}static getAttr(t,a){if(Array.isArray(a)){const n=a.shift();return n&&typeof t[n]=="object"?j.getAttr(t[n],a):!a.length&&n?t[n]:null}return j.getAttr(t,a.split("."))}static isIp(t){if(typeof t=="string"){if(t.match(/^\d+\.\d+\.\d+\.\d+$/))return"ipv4";if(t.match(/^[\da-fA-F:]+$/))return"ipv6"}return null}componentWillUnmount(){super.componentWillUnmount(),this.props.oContext.socket.unsubscribeState(`system.adapter.kisshome-defender.${this.props.oContext.instance}.alive`,this.onAliveChanged),this.validateTimeout&&(clearTimeout(this.validateTimeout),this.validateTimeout=null),this.statusPolling&&(clearInterval(this.statusPolling),this.statusPolling=null)}onAliveChanged=(t,a)=>{this.state.alive!==!!(a!=null&&a.val)&&this.setState({alive:!!(a!=null&&a.val)},()=>{this.state.alive&&(this.resolveDone?this.validateAddresses():this.resolveMACs(),this.pollModelStatus())})};validateAddresses(){this.validateTimeout&&clearTimeout(this.validateTimeout),this.validateTimeout=setTimeout(()=>{if(this.validateTimeout=null,!this.state.alive)return;const t=[],a=b.ConfigGeneric.getValue(this.props.data,"devices")||[],n={...this.state.IP2MAC},o={...this.state.MAC2VENDOR};a.forEach(d=>{const e=V(d.ip),s=I(d.mac);e&&M(d.ip)&&!n[e]?(n[e]="-",t.push(d),d.mac&&A(d.mac)&&!o[s]&&(o[s]="-")):d.mac&&A(d.mac)&&!o[s]&&(o[s]="-",t.push(d))}),t.length&&this.setState({resolving:!0,IP2MAC:n,MAC2VENDOR:o},()=>{this.props.oContext.socket.sendTo(`kisshome-defender.${this.props.oContext.instance}`,"getMacForIps",t).then(d=>{var p;if(d!=null&&d.error){this.setState({resolving:!1});return}const e=d,s={...this.state.IP2MAC},c={...this.state.MAC2VENDOR};let r=!1;(p=e==null?void 0:e.result)==null||p.forEach(l=>{l.ip=I(l.ip),l.mac=I(l.mac),l.mac&&s[l.ip]!==l.mac&&(s[l.ip]=l.mac,r=!0),l.vendor&&c[l.mac]!==l.vendor&&(c[l.mac]=l.vendor,r=!0)}),r&&this.setState({IP2MAC:s,MAC2VENDOR:c,resolving:!1})})})},1e3)}async collectIpAddresses(t,a,n){let o=[];t||=this.state.instances;for(let e=0;e<t.length;e++){const s=Y.find(c=>c.adapter===t[e].name);if(s&&t[e].native){const c=s.attr;if(c&&t[e].native[c])if(s.arrayAttr){if(Array.isArray(t[e].native[c]))for(let r=0;r<t[e].native[c].length;r++){const p=t[e].native[c][r],l=j.getAttr(p,s.arrayAttr),m=j.isIp(l);if(m){const y=n.find(T=>T.ip===l);o.push({ip:l,type:m,desc:t[e].name,uuid:(y==null?void 0:y.uuid)||S()})}}}else{const r=j.getAttr(t[e].native,c),p=j.isIp(r);if(p){const l=n.find(m=>m.ip===r);o.push({ip:r,type:p,desc:t[e].name,uuid:(l==null?void 0:l.uuid)||S()})}}if(s.browse)try{(await s.browse(this.props.oContext.socket,t[e].id.replace("system.adapter.",""))).forEach(p=>{const l=j.isIp(p.ip);if(l){const m=n.find(y=>y.ip===p.ip);o.push({ip:p.ip,type:l,desc:p.name||t[e].name,uuid:(m==null?void 0:m.uuid)||S()})}})}catch(r){console.error(`Cannot collect "${JSON.stringify(t[e])}": ${r}`)}if(s.clients)try{(await K(this.props.oContext.socket,t[e].id.replace("system.adapter.",""))).forEach(p=>{const l=j.isIp(p.ip);if(l){const m=n.find(y=>y.ip===p.ip);o.push({ip:p.ip,type:l,desc:p.name||t[e].name,uuid:(m==null?void 0:m.uuid)||S()})}})}catch(r){console.error(`Cannot collect "${JSON.stringify(t[e])}": ${r}`)}}else if(t[e].native.ip&&typeof t[e].native.ip=="string"&&t[e].native.ip.match(/^\d+\.\d+\.\d+\.\d+$/)){const c=n.find(r=>r.ip===t[e].native.ip);o.push({ip:t[e].native.ip,type:"ipv4",desc:t[e].name,uuid:(c==null?void 0:c.uuid)||S()})}else if(t[e].native.host&&typeof t[e].native.host=="string"&&t[e].native.host.match(/^\d+\.\d+\.\d+\.\d+$/)){const c=n.find(r=>r.ip===t[e].native.host);o.push({ip:t[e].native.host,type:"ipv4",desc:t[e].name,uuid:(c==null?void 0:c.uuid)||S()})}}o=o.filter(e=>!a.includes(e.ip)&&e.ip!=="0.0.0.0"&&e.ip!=="localhost"&&e.ip!=="127.0.0.1"&&e.ip!=="::1"&&e.type==="ipv4");const d=[];for(let e=0;e<o.length;e++)d.find(s=>s.ip===o[e].ip)||d.push(o[e]);return d}renderMessage(){return this.state.showMessage?h.jsx(_.Message,{text:_.I18n.t("custom_kisshome_You cannot record the traffic of Fritz!Box"),onClose:()=>this.setState({showMessage:!1})}):null}disableFritzBox(){const t=b.ConfigGeneric.getValue(this.props.data,"devices")||[],a=b.ConfigGeneric.getValue(this.props.data,"fritzbox");let n=!1;t.forEach(o=>{o.ip===a&&o.enabled&&(n=!0,o.enabled=!1)}),n&&this.onChange("devices",t)}checkDevices(t){if(t.find(a=>(a.desc||"").length<3))this.props.onError("devices",_.I18n.t("custom_kisshome_name_too_short"));else if(t.find(a=>!a.ip&&!a.mac))this.props.onError("devices",_.I18n.t("custom_kisshome_name_ip_and_mac_missing"));else if(t.find(a=>!M(a.ip)))this.props.onError("devices",_.I18n.t("custom_kisshome_name_invalid_ip"));else if(t.find(a=>!A(a.mac)))this.props.onError("devices",_.I18n.t("custom_kisshome_name_invalid_mac"));else{const a=t.filter(n=>n.enabled&&n.ip).map(n=>n.ip);if(a.length!==new Set(a).size)this.props.onError("devices",_.I18n.t("custom_kisshome_duplicate_ip"));else{const n=t.filter(o=>o.enabled&&o.mac).map(o=>o.mac);n.length!==new Set(n).size?this.props.onError("devices",_.I18n.t("custom_kisshome_duplicate_mac")):this.props.onError("devices")}}}renderModelStatus(t){var n;if(!t||!((n=this.state.modelStatus)!=null&&n[t]))return h.jsx("span",{children:"--"});const a=this.state.modelStatus[t];return h.jsxs("span",{title:JSON.stringify(a),children:[a.progress,"%",a.description?` [${a.description}]`:""]})}renderItem(){var d;const t=b.ConfigGeneric.getValue(this.props.data,"devices")||[],a=b.ConfigGeneric.getValue(this.props.data,"fritzbox");t.forEach(e=>{e.uuid||(e.uuid=S())});const n=this.state.ips?t.filter(e=>!this.state.ips.find(s=>s.ip===e.ip&&s.uuid===e.uuid)):t,o=t.every(e=>e.enabled)&&(this.state.ips?this.state.ips.every(e=>t.find(s=>s.ip===e.ip)):!0);return h.jsxs(u.TableContainer,{children:[this.renderMessage(),this.state.runningRequest||this.state.resolving?h.jsx(u.LinearProgress,{}):h.jsx("div",{style:{height:2,width:"100%"}}),h.jsxs(u.Table,{style:g.table,size:"small",children:[h.jsx(u.TableHead,{children:h.jsxs(u.TableRow,{children:[h.jsxs(u.TableCell,{style:{...g.header,width:120},children:[h.jsx(u.Checkbox,{title:o?_.I18n.t("custom_kisshome_unselect_all"):_.I18n.t("custom_kisshome_select_all"),checked:o,indeterminate:!o&&t.length>0,disabled:this.state.runningRequest,onClick:()=>{const e=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]];if(o){e.forEach(s=>s.enabled=!1);for(let s=e.length-1;s>=0;s--)this.state.ips.find(c=>c.ip===e[s].ip)&&e.splice(s,1)}else e.forEach(s=>s.enabled=!0),this.state.ips.forEach(s=>{!e.find(c=>s.ip===c.ip)&&s.ip!==a&&e.push({ip:s.ip,mac:s.mac,desc:s.desc,enabled:!0,uuid:s.uuid})}),e.forEach(s=>s.enabled=!0);this.onChange("devices",e)}}),h.jsx(u.Fab,{onClick:()=>{const e=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]];e.push({ip:"",mac:"",desc:"",enabled:!0,uuid:S()}),this.onChange("devices",e),this.checkDevices(e)},size:"small",disabled:this.state.runningRequest,children:h.jsx($.Add,{})})]}),h.jsx(u.TableCell,{style:g.header,children:_.I18n.t("custom_kisshome_ip")}),h.jsx(u.TableCell,{style:g.header,children:_.I18n.t("custom_kisshome_mac")}),h.jsx(u.TableCell,{style:g.header,children:_.I18n.t("custom_kisshome_vendor")}),h.jsx(u.TableCell,{style:g.header,children:_.I18n.t("custom_kisshome_name")}),h.jsx(u.TableCell,{style:g.header,title:"custom_kisshome_training_status_tooltip",children:_.I18n.t("custom_kisshome_training_status")}),h.jsx(u.TableCell,{style:g.header})]})}),h.jsxs(u.TableBody,{children:[(d=this.state.ips)==null?void 0:d.map(e=>{var s,c;return h.jsxs(u.TableRow,{children:[h.jsx(u.TableCell,{scope:"row",style:g.td,children:h.jsx(u.Checkbox,{checked:!!((s=t.find(r=>r.uuid===e.uuid))!=null&&s.enabled),disabled:this.state.runningRequest,onClick:()=>{const r=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],p=r.findIndex(l=>l.uuid===e.uuid);if(p===-1){const l=r.findIndex(m=>m.ip===e.ip);if(l!==-1){const m=JSON.parse(JSON.stringify(this.state.ips)),y=m.find(T=>T.uuid===e.uuid);y&&(y.uuid=r[l].uuid),r[l].enabled=!0,this.setState({ips:m},()=>this.onChange("devices",r))}else{if(e.ip===a){this.setState({showMessage:!0});return}r.push({ip:e.ip,mac:e.mac,desc:e.desc,enabled:!0,uuid:e.uuid})}}else r.splice(p,1);this.onChange("devices",r)}})}),h.jsx(u.TableCell,{style:g.td,children:e.ip}),h.jsx(u.TableCell,{style:g.td,children:e.mac||""}),h.jsx(u.TableCell,{style:{...g.td,...g.vendor},children:((c=this.state.MAC2VENDOR)==null?void 0:c[I(e.mac)])||""}),h.jsx(u.TableCell,{style:g.td,children:e.desc}),h.jsx(u.TableCell,{style:g.td,children:this.renderModelStatus(e.mac)}),h.jsx(u.TableCell,{style:g.td})]},e.uuid)}),n.map(e=>{var m,y,T;const s=V(e.ip),c=I(e.mac),r=(m=this.state.IP2MAC)==null?void 0:m[s],p=e.ip&&e.enabled&&t.filter(v=>e.ip===v.ip).length>1?_.I18n.t("custom_kisshome_duplicate_ip"):"",l=e.mac&&e.enabled&&t.filter(v=>e.mac===v.mac).length>1?_.I18n.t("custom_kisshome_duplicate_mac"):"";return h.jsxs(u.TableRow,{children:[h.jsx(u.TableCell,{scope:"row",style:g.td,children:h.jsx(u.Checkbox,{checked:!!e.enabled,disabled:this.state.runningRequest,onClick:()=>{const v=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],f=v.find(C=>C.uuid===e.uuid);if(f){if(!f.enabled&&e.ip===a){this.setState({showMessage:!0});return}f.enabled=!f.enabled,this.onChange("devices",v)}}})}),h.jsx(u.TableCell,{style:g.td,children:h.jsx(u.TextField,{fullWidth:!0,error:!!p||!M(e.ip)||!e.ip&&!e.mac,helperText:p||(M(e.ip)?!e.ip&&!e.mac?_.I18n.t("custom_kisshome_name_ip_and_mac_missing"):"":_.I18n.t("custom_kisshome_name_invalid_ip")),value:e.ip,disabled:this.state.runningRequest,placeholder:"192.168.x.y",onChange:v=>{const f=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],C=f.find(k=>k.uuid===e.uuid);C&&(C.ip=v.target.value,C.ip===a&&C.enabled&&setTimeout(()=>this.disableFritzBox(),300),this.onChange("devices",f),this.validateAddresses(),this.checkDevices(f))},onBlur:()=>{if(e.ip.trim()&&s!==e.ip){const v=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],f=v.find(C=>C.uuid===e.uuid);f&&(f.ip=s,this.onChange("devices",v),this.checkDevices(v))}},variant:"standard"})}),h.jsx(u.TableCell,{style:g.td,children:h.jsx(u.TextField,{fullWidth:!0,value:e.mac,disabled:this.state.runningRequest,error:!!l||!A(e.mac)||!e.ip&&!e.mac,helperText:l||(A(e.mac)?!e.ip&&!e.mac?_.I18n.t("custom_kisshome_name_ip_and_mac_missing"):"":_.I18n.t("custom_kisshome_name_invalid_mac")),placeholder:r||"XX:XX:XX:XX:XX:XX",onChange:v=>{const f=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],C=f.find(k=>k.uuid===e.uuid);C&&(C.mac=v.target.value,this.onChange("devices",f),this.validateAddresses(),this.checkDevices(f))},onBlur:()=>{if(e.mac.trim()){const v=c;if(v!==e.mac){const f=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],C=f.find(k=>k.uuid===e.uuid);C&&(C.mac=v,this.onChange("devices",f),this.checkDevices(f))}}},variant:"standard"})}),h.jsx(u.TableCell,{style:{...g.td,...g.vendor},children:e.mac?((y=this.state.MAC2VENDOR)==null?void 0:y[c])||"":r&&((T=this.state.MAC2VENDOR)==null?void 0:T[r])||""}),h.jsx(u.TableCell,{style:g.td,children:h.jsx(u.TextField,{fullWidth:!0,value:e.desc,disabled:this.state.runningRequest,onChange:v=>{const f=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],C=f.find(k=>k.uuid===e.uuid);C&&(C.desc=v.target.value,this.onChange("devices",f),this.checkDevices(f))},helperText:(e.desc||"").length>=3?"":_.I18n.t("custom_kisshome_name_too_short"),error:(e.desc||"").length<3,variant:"standard"})}),h.jsx(u.TableCell,{style:g.td,children:this.renderModelStatus(c)}),h.jsx(u.TableCell,{style:g.td,children:h.jsx(u.IconButton,{disabled:this.state.runningRequest,onClick:()=>{const v=[...b.ConfigGeneric.getValue(this.props.data,"devices")||[]],f=v.findIndex(C=>C.uuid===e.uuid);f!==-1&&(v.splice(f,1),this.onChange("devices",v),this.checkDevices(v))},children:h.jsx($.Delete,{})})})]},e.uuid)})]})]})]})}}export{j as C};
